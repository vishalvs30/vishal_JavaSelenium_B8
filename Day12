/*
 Question:
 1. Create procedure or functions for employee table:
    1) Add 5000 bonus to all employees.
    2) Print same name employees.
    3) Print highest and lowest salary from employee table.
 */
 import java.sql.*;

public class EmployeeProcedureDemo {
    public static void main(String[] args) {
        String url = "jdbc:mysql://localhost:3306/mydb";
        String user = "root";
        String pass = "root";

        try (Connection con = DriverManager.getConnection(url, user, pass)) {

            // 1. Add 5000 Bonus to all employees
            CallableStatement cs1 = con.prepareCall("{CALL add_bonus()}");
            cs1.execute();
            System.out.println("Bonus added successfully.\n");

            // 2. Employees having duplicate names
            CallableStatement cs2 = con.prepareCall("{CALL print_duplicate_names()}");
            ResultSet rs1 = cs2.executeQuery();
            System.out.println("Employees with same names:");
            while (rs1.next()) {
                System.out.println(rs1.getString("emp_name") + " - " + rs1.getInt("count") + " times");
            }

            // 3. Print highest and lowest salary
            CallableStatement cs3 = con.prepareCall("{CALL salary_stats()}");
            ResultSet rs2 = cs3.executeQuery();
            if (rs2.next()) {
                System.out.println("\nHighest Salary: " + rs2.getDouble("highest_salary"));
                System.out.println("Lowest Salary: " + rs2.getDouble("lowest_salary"));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}
Question:
 2. Create procedure or functions for Hospital table:
    1) Print avg patient count on daily basis.
    2) Print all the patients whose belong to same ward.
    3) Arrange the patients list according their admission date.
    
    import java.sql.*;

public class HospitalData {
    public static void main(String[] args) {
        String url = "jdbc:mysql://localhost:3306/mydb";
        String user = "root";
        String password = "root";

        try (Connection con = DriverManager.getConnection(url, user, password)) {
            System.out.println("Connected to DB...");

            // 1. Average patient count daily
            CallableStatement cs1 = con.prepareCall("{CALL avg_patient_count_daily()}");
            ResultSet rs1 = cs1.executeQuery();
            while (rs1.next()) {
                System.out.println("Average patients per day: " + rs1.getDouble("avg_patient_per_day"));
            }

            // 2. Patients from the same ward
            CallableStatement cs2 = con.prepareCall("{CALL patients_same_ward()}");
            ResultSet rs2 = cs2.executeQuery();
            System.out.println("\nPatients in same ward:");
            while (rs2.next()) {
                System.out.println(rs2.getInt("patient_id") + " - " + rs2.getString("name") +
                                   " (Ward: " + rs2.getInt("ward_no") + ")");
            }

            // 3. Patients ordered by admission date
            CallableStatement cs3 = con.prepareCall("{CALL patients_by_admission()}");
            ResultSet rs3 = cs3.executeQuery();
            System.out.println("\nPatients by admission date:");
            while (rs3.next()) {
                System.out.println(rs3.getInt("patient_id") + " - " + rs3.getString("name") +
                                   " (Admitted: " + rs3.getDate("admission_date") + ")");
            }

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
    
    
    
    